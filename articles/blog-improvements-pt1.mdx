---
title: Improving the Blog
description: It wasn't even public
date: '2023-03-03'
category: Technology
---

## Starting Point

Don't laugh at the image below, the blog started out pretty rough.

![Picture of the Original Blog](/articles/images/original_blog.png)

Moving in to 2023 I felt that I'd reached my mid blog-life crisis and a refresh was required.

### Migrating to NextJS

NextJS provides a number of advantages over the traditional React framework:
- Static site generation
- MDX support
- File based routing
- Image optimization

### Converting to MDX

I've been using MDX for a couple of separate sites I've been building - it allows th flexibility of markdown with the
power of React components. It allows the blog posts to be written in an external editor in a far more readable format,
exported to RSS and allows custom components to be embedded directly.

#### Article Metadata

Welcome `mdx-remote-local`. It allows the metadata to be stored in the markdown file itself, allowing the blog to be built without
having to import customer React components individually designed for each component.

```mdxjs {1-6}
---
title: Improving the Blog
description: It wasn't even public
date: '2023-03-03'
category: Technology
---
```

Alongside this I added some nice-to-haves for the cards that summarise each article, including the reading time for each article
using the `reading-time` library.

It estimates based on an average of 200 words-per-minute how long the article will take to read.

### Tailwind

`styled-components` is a great library, but with some recent projects I've found that it's a bit slower to prototype features,
due to the fact that each component must be templated.

Tailwind on the other hand, allows you to quickly prototype features, whilst still allowing you to customise the styling
to your heart's content. It's also pretty intuitive, so guessing commands becomes second nature.

### Image Lazy Loading

As the website is statically generated, the default `next/image` support for lazy loading doesn't work.

I've used the `next-image-export-optimizer` package to generate the images at build time, alongside the `rehype-img-size`
plugin. The plugin ensures that the image size can be extracted from the embedded *mdx* images, whilst the export provides images
in a number of sizes in the *WebP* format. This allows the image to be lazy-loaded by the browser, which can then be replaced
by the high-quality image once it's downloaded.

### Dark Mode

I thought this would be a relatively simple task, but it turned out to be a little more complicated than I'd anticipated.

The `next-themes` package provides a simple way to switch between light and dark mode, using the `prefers-color-scheme` media query,
and integrates quite nicely with `tailwind`.

```tsx {1-10}
import { useTheme } from 'next-themes';

const ThemeToggle = () => {
  const { theme, setTheme } = useTheme();

  return (
    <HeaderIcon onClick={() => setTheme(theme === 'light' ? 'dark' : 'light')}>
      {theme === 'light' ? <RiMoonClearLine size={25} /> : <RiSunLine size={25} />}
    </HeaderIcon>
  );
};
```

However, due to the fact that each page is generated from `mdx`, switching the styling is slightly more complicated.

To get around this I added a custom `scss` which ensures that when the `data-theme` is switched, the correct code blocks are
displayed.

```scss {1-12}
html.dark {
  pre[data-theme="light"],
  code[data-theme="light"] {
    display: none;
  }
}

html.light {
  pre[data-theme="dark"],
  code[data-theme="dark"] {
    display: none;
  }
}
```

### Absolute Paths

NextJS allows you to import files from the root of the project, which is great for importing images and other files.

Simply adding the config to the `tsconfig.json` file allows you to import files from the root of the project.
```
"baseUrl": ".",
```

### Part Two

> Adding an RSS Feed
> Adding a Sitemap
> Adding a 404 Page
